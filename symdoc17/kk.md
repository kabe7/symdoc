---
title: Network Optimisation
layout: page
---



#力学モデルを用いたグラフ描画

グラフを描画する際、頂点の配置をどのようにするかということは視覚的な理解に大きな影響を及ぼす。
本記事では、グラフの頂点と辺に仮想的な力を割り当て、力学的エネルギーの低い安定状態を探して
グラフのレイアウトを求める*kamada-kawai*法を用いる。



##力学的エネルギーの定義

まず、グラフの全頂点がばねで結ばれていると仮定すると、系全体の力学的エネルギーは次で表される。
$$E = \frac{1}{2} \sum_{\substack{0 \leq i \leq 2\\0 \leq j \leq 2}} \frac{k_{i,j}}{2} \left(\sqrt{\left(P_{i,0} - P_{j,0}\right)^{2} + \left(P_{i,1} - P_{j,1}\right)^{2}} - l_{i,j}\right)^{2}$$
ただし、$P_{i,d}$はi番目の頂点の座標の第$j$成分、$k_{i,j},l_{i,j}$はそれぞれ頂点$i$と頂点$j$の間のばね定数、自然長とする。

$k_{i,j},l_{i,j}$は、$d_{i,j}$を頂点$i$と頂点$j$を結ぶ最短経路の長さとして
$$k_{i,j} = K / d_{i,j}^2 (i \neq j) \ \  0(i = j)$$
$$l_{i,j} = L \times d_{i,j}$$
で定める。($K,L$は定数)
$d_{i,j}$は*Warshall-Floyd*のアルゴリズムにより求めることができる。



##エネルギーの最小化

例として、頂点数が3,次元が2であるときを考える。
力学的エネルギーが最小になる点では、$gradE = \vec 0$が成り立つ。
すなわち、$6$本の非線型連立方程式を解けばよいのだが、これを解析的に解くのは難しい。
そこで、Newton-Raphson法を用いて近似解を求める。

##近似解の導出
まず、$\|\frac{d}{d P_{m}} E{\left (P_{m} \right )}\||$が最大となる添字$i$を探す($P_i$はベクトルであることに注意)。
このとき、$P_i$の各成分を変数としたときのEのヤコビアンを$J_i$、ヘッシアンを$H_i$として
$$H_m \Delta P_m = -J_m$$
により変位$\Delta P_i$を求め、$P_i = P_i + \Delta P_i$により座標を更新する。
例えば、$i=1$だとすると、$\Delta P_1を求める式は$
$$\left(\begin{matrix}\frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) k_{1,0}}{2 \sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}}} + \frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,0} - P_{1,0}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{\left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) k_{0,1}}{2 \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}}} + \frac{k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,0} - P_{1,0}\right) + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) k_{2,1}}{2 \sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}}} + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) \left(- P_{1,0} + P_{2,0}\right) \left(P_{1,0} - P_{2,0}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{\left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) k_{1,2}}{2 \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}}} + \frac{k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) \left(- P_{1,0} + P_{2,0}\right) \left(P_{1,0} - P_{2,0}\right) + \frac{\left(P_{1,0} - P_{2,0}\right)^{2} k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)} + \frac{\left(P_{1,0} - P_{2,0}\right)^{2} k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right)^{2} k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right)^{2} k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)} & \frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,1} - P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,1} - P_{1,1}\right) + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) \left(P_{1,0} - P_{2,0}\right) \left(- P_{1,1} + P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) \left(P_{1,0} - P_{2,0}\right) \left(- P_{1,1} + P_{2,1}\right) + \frac{\left(P_{1,0} - P_{2,0}\right) \left(P_{1,1} - P_{2,1}\right) k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)} + \frac{\left(P_{1,0} - P_{2,0}\right) \left(P_{1,1} - P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)}\\\frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,1} - P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,1} - P_{1,1}\right) + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) \left(P_{1,0} - P_{2,0}\right) \left(- P_{1,1} + P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) \left(P_{1,0} - P_{2,0}\right) \left(- P_{1,1} + P_{2,1}\right) + \frac{\left(P_{1,0} - P_{2,0}\right) \left(P_{1,1} - P_{2,1}\right) k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)} + \frac{\left(P_{1,0} - P_{2,0}\right) \left(P_{1,1} - P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)} & \frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) k_{1,0}}{2 \sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}}} + \frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) \left(P_{0,1} - P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{\left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) k_{0,1}}{2 \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}}} + \frac{k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) \left(- P_{0,1} + P_{1,1}\right) \left(P_{0,1} - P_{1,1}\right) + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) k_{2,1}}{2 \sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}}} + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) \left(- P_{1,1} + P_{2,1}\right) \left(P_{1,1} - P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{\left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) k_{1,2}}{2 \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}}} + \frac{k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) \left(- P_{1,1} + P_{2,1}\right) \left(P_{1,1} - P_{2,1}\right) + \frac{\left(P_{1,1} - P_{2,1}\right)^{2} k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)} + \frac{\left(P_{1,1} - P_{2,1}\right)^{2} k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)} + \frac{\left(- P_{0,1} + P_{1,1}\right)^{2} k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)} + \frac{\left(- P_{0,1} + P_{1,1}\right)^{2} k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)}\end{matrix}\right)\Delta P_1 = -\left(\begin{matrix}\frac{1}{2 \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}}} \left(- \left(\left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) k_{0,1} + \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{1,0}\right) k_{1,0}\right) \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} \left(P_{0,0} - P_{1,0}\right) + \left(\left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) k_{1,2} + \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{2,1}\right) k_{2,1}\right) \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} \left(P_{1,0} - P_{2,0}\right)\right)\\\frac{1}{2 \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}}} \left(- \left(\left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) k_{0,1} + \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{1,0}\right) k_{1,0}\right) \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} \left(P_{0,1} - P_{1,1}\right) + \left(\left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) k_{1,2} + \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{2,1}\right) k_{2,1}\right) \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} \left(P_{1,1} - P_{2,1}\right)\right)\end{matrix}\right) $$
となる。
以上を繰り返し、$max_i \|\frac{d}{d P_{m}} E{\left (P_{m} \right )}\||$が十分小さくなったら更新を終了して
その時の座標を力学的エネルギー$E$が最小となる解とする




##グラフdouble_triangleの描画

頂点を['0', '1', '2', '3', '4', '5']、隣接する点のリストを["['2', '3']", "['4', '5']", "['0', '3', '5']", "['0', '2']", "['1', '5']", "['1', '2', '4']"]とすると、最短経路行列$D$,ばね定数行列$K$,自然長行列$L$は次のようになる。
$$D = \left(\begin{matrix}2.0 & 3.0 & 1.0 & 1.0 & 3.0 & 2.0\\3.0 & 2.0 & 2.0 & 3.0 & 1.0 & 1.0\\1.0 & 2.0 & 2.0 & 1.0 & 2.0 & 1.0\\1.0 & 3.0 & 1.0 & 2.0 & 3.0 & 2.0\\3.0 & 1.0 & 2.0 & 3.0 & 2.0 & 1.0\\2.0 & 1.0 & 1.0 & 2.0 & 1.0 & 2.0\end{matrix}\right),K = \left(\begin{matrix}0.0 & 1.11111111111111 & 10.0 & 10.0 & 1.11111111111111 & 2.5\\1.11111111111111 & 0.0 & 2.5 & 1.11111111111111 & 10.0 & 10.0\\10.0 & 2.5 & 0.0 & 10.0 & 2.5 & 10.0\\10.0 & 1.11111111111111 & 10.0 & 0.0 & 1.11111111111111 & 2.5\\1.11111111111111 & 10.0 & 2.5 & 1.11111111111111 & 0.0 & 10.0\\2.5 & 10.0 & 10.0 & 2.5 & 10.0 & 0.0\end{matrix}\right),L = \left(\begin{matrix}0.0 & 30.0 & 10.0 & 10.0 & 30.0 & 20.0\\30.0 & 0.0 & 20.0 & 30.0 & 10.0 & 10.0\\10.0 & 20.0 & 0.0 & 10.0 & 20.0 & 10.0\\10.0 & 30.0 & 10.0 & 0.0 & 30.0 & 20.0\\30.0 & 10.0 & 20.0 & 30.0 & 0.0 & 10.0\\20.0 & 10.0 & 10.0 & 20.0 & 10.0 & 0.0\end{matrix}\right)$$
このとき、ランダム生成した座標からkamada-kawai法により頂点位置の最適化を行なうと、頂点座標は次のようになる。
$$P = \left(\begin{matrix}10.0153452000519 & -4.78212568783798\\-15.6209409469126 & 10.76297622507\\0.506545926573067 & -1.02375439811795\\2.38115183423247 & -11.0750773868165\\-7.9870170861673 & 17.0562028552577\\-6.11194112407809 & 7.0049680118998\end{matrix}\right)$$

プロットした画像は次のようになる。

![img](pics/double_triangle.png)




##グラフcubeの描画

頂点を['0', '1', '2', '3', '4', '5', '6', '7']、隣接する点のリストを["['1', '3', '4']", "['0', '2', '5']", "['1', '3', '6']", "['0', '2', '7']", "['0', '5', '7']", "['1', '4', '6']", "['2', '5', '7']", "['3', '4', '6']"]とすると、最短経路行列$D$,ばね定数行列$K$,自然長行列$L$は次のようになる。
$$D = \left(\begin{matrix}2.0 & 1.0 & 2.0 & 1.0 & 1.0 & 2.0 & 3.0 & 2.0\\1.0 & 2.0 & 1.0 & 2.0 & 2.0 & 1.0 & 2.0 & 3.0\\2.0 & 1.0 & 2.0 & 1.0 & 3.0 & 2.0 & 1.0 & 2.0\\1.0 & 2.0 & 1.0 & 2.0 & 2.0 & 3.0 & 2.0 & 1.0\\1.0 & 2.0 & 3.0 & 2.0 & 2.0 & 1.0 & 2.0 & 1.0\\2.0 & 1.0 & 2.0 & 3.0 & 1.0 & 2.0 & 1.0 & 2.0\\3.0 & 2.0 & 1.0 & 2.0 & 2.0 & 1.0 & 2.0 & 1.0\\2.0 & 3.0 & 2.0 & 1.0 & 1.0 & 2.0 & 1.0 & 2.0\end{matrix}\right),K = \left(\begin{matrix}0.0 & 10.0 & 2.5 & 10.0 & 10.0 & 2.5 & 1.11111111111111 & 2.5\\10.0 & 0.0 & 10.0 & 2.5 & 2.5 & 10.0 & 2.5 & 1.11111111111111\\2.5 & 10.0 & 0.0 & 10.0 & 1.11111111111111 & 2.5 & 10.0 & 2.5\\10.0 & 2.5 & 10.0 & 0.0 & 2.5 & 1.11111111111111 & 2.5 & 10.0\\10.0 & 2.5 & 1.11111111111111 & 2.5 & 0.0 & 10.0 & 2.5 & 10.0\\2.5 & 10.0 & 2.5 & 1.11111111111111 & 10.0 & 0.0 & 10.0 & 2.5\\1.11111111111111 & 2.5 & 10.0 & 2.5 & 2.5 & 10.0 & 0.0 & 10.0\\2.5 & 1.11111111111111 & 2.5 & 10.0 & 10.0 & 2.5 & 10.0 & 0.0\end{matrix}\right),L = \left(\begin{matrix}0.0 & 10.0 & 20.0 & 10.0 & 10.0 & 20.0 & 30.0 & 20.0\\10.0 & 0.0 & 10.0 & 20.0 & 20.0 & 10.0 & 20.0 & 30.0\\20.0 & 10.0 & 0.0 & 10.0 & 30.0 & 20.0 & 10.0 & 20.0\\10.0 & 20.0 & 10.0 & 0.0 & 20.0 & 30.0 & 20.0 & 10.0\\10.0 & 20.0 & 30.0 & 20.0 & 0.0 & 10.0 & 20.0 & 10.0\\20.0 & 10.0 & 20.0 & 30.0 & 10.0 & 0.0 & 10.0 & 20.0\\30.0 & 20.0 & 10.0 & 20.0 & 20.0 & 10.0 & 0.0 & 10.0\\20.0 & 30.0 & 20.0 & 10.0 & 10.0 & 20.0 & 10.0 & 0.0\end{matrix}\right)$$
このとき、ランダム生成した座標からkamada-kawai法により頂点位置の最適化を行なうと、頂点座標は次のようになる。
$$P = \left(\begin{matrix}8.72943602668481 & 3.23905673749775\\15.5280870507712 & -6.94650275884476\\4.714943362793 & -6.16056225587634\\-1.28270289126781 & 3.96868156153436\\16.9263133044473 & 12.3416486584704\\22.9239485695035 & 2.2123941380819\\12.9118135158373 & 2.94207317764793\\6.11314925797029 & 13.127590656225\end{matrix}\right)$$

プロットした画像は次のようになる。

![img](pics/cube.png)



