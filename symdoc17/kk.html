<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Network Optimisation</title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
</head>
<body>
<div id="header">
<h1 class="title">Network Optimisation</h1>
</div>
<h1 id="力学モデルを用いたグラフ描画">力学モデルを用いたグラフ描画</h1>
<p>グラフを描画する際、頂点の配置をどのようにするかということは視覚的な理解に大きな影響を及ぼす。 本記事では、グラフの頂点と辺に仮想的な力を割り当て、力学的エネルギーの低い安定状態を探して グラフのレイアウトを求める<em>kamada-kawai</em>法を用いる。</p>
<h2 id="力学的エネルギーの定義">力学的エネルギーの定義</h2>
<p>まず、グラフの全頂点がばねで結ばれていると仮定すると、系全体の力学的エネルギーは次で表される。 <span class="math display">\[E = \frac{1}{2} \sum_{\substack{0 \leq i \leq 2\\0 \leq j \leq 2}} \frac{k_{i,j}}{2} \left(\sqrt{\left(P_{i,0} - P_{j,0}\right)^{2} + \left(P_{i,1} - P_{j,1}\right)^{2}} - l_{i,j}\right)^{2}\]</span> ただし、<span class="math inline">\(P_{i,d}\)</span>はi番目の頂点の座標の第<span class="math inline">\(j\)</span>成分、<span class="math inline">\(k_{i,j},l_{i,j}\)</span>はそれぞれ頂点<span class="math inline">\(i\)</span>と頂点<span class="math inline">\(j\)</span>の間のばね定数、自然長とする。</p>
<p><span class="math inline">\(k_{i,j},l_{i,j}\)</span>は、<span class="math inline">\(d_{i,j}\)</span>を頂点<span class="math inline">\(i\)</span>と頂点<span class="math inline">\(j\)</span>を結ぶ最短経路の長さとして <span class="math display">\[k_{i,j} = K / d_{i,j}^2 (i \neq j) \ \  0(i = j)\]</span> <span class="math display">\[l_{i,j} = L \times d_{i,j}\]</span> で定める。(<span class="math inline">\(K,L\)</span>は定数) <span class="math inline">\(d_{i,j}\)</span>は<em>Warshall-Floyd</em>のアルゴリズムにより求めることができる。</p>
<h2 id="エネルギーの最小化">エネルギーの最小化</h2>
<p>例として、頂点数が3,次元が2であるときを考える。 力学的エネルギーが最小になる点では、<span class="math inline">\(gradE = \vec 0\)</span>が成り立つ。 すなわち、<span class="math inline">\(6\)</span>本の非線型連立方程式を解けばよいのだが、これを解析的に解くのは難しい。 そこで、Newton-Raphson法を用いて近似解を求める。</p>
<h2 id="近似解の導出">近似解の導出</h2>
<p>まず、<span class="math inline">\(\|\frac{d}{d P_{m}} E{\left (P_{m} \right )}\||\)</span>が最大となる添字<span class="math inline">\(i\)</span>を探す(<span class="math inline">\(P_i\)</span>はベクトルであることに注意)。 このとき、<span class="math inline">\(P_i\)</span>の各成分を変数としたときのEのヤコビアンを<span class="math inline">\(J_i\)</span>、ヘッシアンを<span class="math inline">\(H_i\)</span>として <span class="math display">\[H_m \Delta P_m = -J_m\]</span> により変位<span class="math inline">\(\Delta P_i\)</span>を求め、<span class="math inline">\(P_i = P_i + \Delta P_i\)</span>により座標を更新する。 例えば、<span class="math inline">\(i=1\)</span>だとすると、<span class="math inline">\(\Delta P_1を求める式は\)</span> <span class="math display">\[\left(\begin{matrix}\frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) k_{1,0}}{2 \sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}}} + \frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,0} - P_{1,0}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{\left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) k_{0,1}}{2 \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}}} + \frac{k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,0} - P_{1,0}\right) + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) k_{2,1}}{2 \sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}}} + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) \left(- P_{1,0} + P_{2,0}\right) \left(P_{1,0} - P_{2,0}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{\left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) k_{1,2}}{2 \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}}} + \frac{k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) \left(- P_{1,0} + P_{2,0}\right) \left(P_{1,0} - P_{2,0}\right) + \frac{\left(P_{1,0} - P_{2,0}\right)^{2} k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)} + \frac{\left(P_{1,0} - P_{2,0}\right)^{2} k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right)^{2} k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right)^{2} k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)} &amp; \frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,1} - P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,1} - P_{1,1}\right) + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) \left(P_{1,0} - P_{2,0}\right) \left(- P_{1,1} + P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) \left(P_{1,0} - P_{2,0}\right) \left(- P_{1,1} + P_{2,1}\right) + \frac{\left(P_{1,0} - P_{2,0}\right) \left(P_{1,1} - P_{2,1}\right) k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)} + \frac{\left(P_{1,0} - P_{2,0}\right) \left(P_{1,1} - P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)}\\\frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,1} - P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) \left(- P_{0,0} + P_{1,0}\right) \left(P_{0,1} - P_{1,1}\right) + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) \left(P_{1,0} - P_{2,0}\right) \left(- P_{1,1} + P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) \left(P_{1,0} - P_{2,0}\right) \left(- P_{1,1} + P_{2,1}\right) + \frac{\left(P_{1,0} - P_{2,0}\right) \left(P_{1,1} - P_{2,1}\right) k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)} + \frac{\left(P_{1,0} - P_{2,0}\right) \left(P_{1,1} - P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)} + \frac{\left(- P_{0,0} + P_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)} &amp; \frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) k_{1,0}}{2 \sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}}} + \frac{\left(\sqrt{\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}} - l_{1,0}\right) \left(- P_{0,1} + P_{1,1}\right) \left(P_{0,1} - P_{1,1}\right) k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{\left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) k_{0,1}}{2 \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}}} + \frac{k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) \left(- P_{0,1} + P_{1,1}\right) \left(P_{0,1} - P_{1,1}\right) + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) k_{2,1}}{2 \sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}}} + \frac{\left(\sqrt{\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}} - l_{2,1}\right) \left(- P_{1,1} + P_{2,1}\right) \left(P_{1,1} - P_{2,1}\right) k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} + \frac{\left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) k_{1,2}}{2 \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}}} + \frac{k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)^{\frac{3}{2}}} \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) \left(- P_{1,1} + P_{2,1}\right) \left(P_{1,1} - P_{2,1}\right) + \frac{\left(P_{1,1} - P_{2,1}\right)^{2} k_{1,2}}{2 \left(\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}\right)} + \frac{\left(P_{1,1} - P_{2,1}\right)^{2} k_{2,1}}{2 \left(\left(- P_{1,0} + P_{2,0}\right)^{2} + \left(- P_{1,1} + P_{2,1}\right)^{2}\right)} + \frac{\left(- P_{0,1} + P_{1,1}\right)^{2} k_{0,1}}{2 \left(\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}\right)} + \frac{\left(- P_{0,1} + P_{1,1}\right)^{2} k_{1,0}}{2 \left(\left(- P_{0,0} + P_{1,0}\right)^{2} + \left(- P_{0,1} + P_{1,1}\right)^{2}\right)}\end{matrix}\right)\Delta P_1 = -\left(\begin{matrix}\frac{1}{2 \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}}} \left(- \left(\left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) k_{0,1} + \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{1,0}\right) k_{1,0}\right) \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} \left(P_{0,0} - P_{1,0}\right) + \left(\left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) k_{1,2} + \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{2,1}\right) k_{2,1}\right) \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} \left(P_{1,0} - P_{2,0}\right)\right)\\\frac{1}{2 \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}}} \left(- \left(\left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{0,1}\right) k_{0,1} + \left(\sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} - l_{1,0}\right) k_{1,0}\right) \sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} \left(P_{0,1} - P_{1,1}\right) + \left(\left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{1,2}\right) k_{1,2} + \left(\sqrt{\left(P_{1,0} - P_{2,0}\right)^{2} + \left(P_{1,1} - P_{2,1}\right)^{2}} - l_{2,1}\right) k_{2,1}\right) \sqrt{\left(P_{0,0} - P_{1,0}\right)^{2} + \left(P_{0,1} - P_{1,1}\right)^{2}} \left(P_{1,1} - P_{2,1}\right)\right)\end{matrix}\right) \]</span> となる。 以上を繰り返し、<span class="math inline">\(max_i \|\frac{d}{d P_{m}} E{\left (P_{m} \right )}\||\)</span>が十分小さくなったら更新を終了して その時の座標を力学的エネルギー<span class="math inline">\(E\)</span>が最小となる解とする</p>
<h2 id="グラフdouble_triangleの描画">グラフdouble_triangleの描画</h2>
<p>頂点を['0', '1', '2', '3', '4', '5']、隣接する点のリストを[&quot;['2', '3']&quot;, &quot;['4', '5']&quot;, &quot;['0', '3', '5']&quot;, &quot;['0', '2']&quot;, &quot;['1', '5']&quot;, &quot;['1', '2', '4']&quot;]とすると、最短経路行列<span class="math inline">\(D\)</span>,ばね定数行列<span class="math inline">\(K\)</span>,自然長行列<span class="math inline">\(L\)</span>は次のようになる。 <span class="math display">\[D = \left(\begin{matrix}2.0 &amp; 3.0 &amp; 1.0 &amp; 1.0 &amp; 3.0 &amp; 2.0\\3.0 &amp; 2.0 &amp; 2.0 &amp; 3.0 &amp; 1.0 &amp; 1.0\\1.0 &amp; 2.0 &amp; 2.0 &amp; 1.0 &amp; 2.0 &amp; 1.0\\1.0 &amp; 3.0 &amp; 1.0 &amp; 2.0 &amp; 3.0 &amp; 2.0\\3.0 &amp; 1.0 &amp; 2.0 &amp; 3.0 &amp; 2.0 &amp; 1.0\\2.0 &amp; 1.0 &amp; 1.0 &amp; 2.0 &amp; 1.0 &amp; 2.0\end{matrix}\right),K = \left(\begin{matrix}0.0 &amp; 1.11111111111111 &amp; 10.0 &amp; 10.0 &amp; 1.11111111111111 &amp; 2.5\\1.11111111111111 &amp; 0.0 &amp; 2.5 &amp; 1.11111111111111 &amp; 10.0 &amp; 10.0\\10.0 &amp; 2.5 &amp; 0.0 &amp; 10.0 &amp; 2.5 &amp; 10.0\\10.0 &amp; 1.11111111111111 &amp; 10.0 &amp; 0.0 &amp; 1.11111111111111 &amp; 2.5\\1.11111111111111 &amp; 10.0 &amp; 2.5 &amp; 1.11111111111111 &amp; 0.0 &amp; 10.0\\2.5 &amp; 10.0 &amp; 10.0 &amp; 2.5 &amp; 10.0 &amp; 0.0\end{matrix}\right),L = \left(\begin{matrix}0.0 &amp; 30.0 &amp; 10.0 &amp; 10.0 &amp; 30.0 &amp; 20.0\\30.0 &amp; 0.0 &amp; 20.0 &amp; 30.0 &amp; 10.0 &amp; 10.0\\10.0 &amp; 20.0 &amp; 0.0 &amp; 10.0 &amp; 20.0 &amp; 10.0\\10.0 &amp; 30.0 &amp; 10.0 &amp; 0.0 &amp; 30.0 &amp; 20.0\\30.0 &amp; 10.0 &amp; 20.0 &amp; 30.0 &amp; 0.0 &amp; 10.0\\20.0 &amp; 10.0 &amp; 10.0 &amp; 20.0 &amp; 10.0 &amp; 0.0\end{matrix}\right)\]</span> このとき、ランダム生成した座標からkamada-kawai法により頂点位置の最適化を行なうと、頂点座標は次のようになる。 <span class="math display">\[P = \left(\begin{matrix}10.0153452000519 &amp; -4.78212568783798\\-15.6209409469126 &amp; 10.76297622507\\0.506545926573067 &amp; -1.02375439811795\\2.38115183423247 &amp; -11.0750773868165\\-7.9870170861673 &amp; 17.0562028552577\\-6.11194112407809 &amp; 7.0049680118998\end{matrix}\right)\]</span></p>
<p>プロットした画像は次のようになる。</p>
<div class="figure">
<img src="pics/double_triangle.png" alt="img" />
<p class="caption">img</p>
</div>
<h2 id="グラフcubeの描画">グラフcubeの描画</h2>
<p>頂点を['0', '1', '2', '3', '4', '5', '6', '7']、隣接する点のリストを[&quot;['1', '3', '4']&quot;, &quot;['0', '2', '5']&quot;, &quot;['1', '3', '6']&quot;, &quot;['0', '2', '7']&quot;, &quot;['0', '5', '7']&quot;, &quot;['1', '4', '6']&quot;, &quot;['2', '5', '7']&quot;, &quot;['3', '4', '6']&quot;]とすると、最短経路行列<span class="math inline">\(D\)</span>,ばね定数行列<span class="math inline">\(K\)</span>,自然長行列<span class="math inline">\(L\)</span>は次のようになる。 <span class="math display">\[D = \left(\begin{matrix}2.0 &amp; 1.0 &amp; 2.0 &amp; 1.0 &amp; 1.0 &amp; 2.0 &amp; 3.0 &amp; 2.0\\1.0 &amp; 2.0 &amp; 1.0 &amp; 2.0 &amp; 2.0 &amp; 1.0 &amp; 2.0 &amp; 3.0\\2.0 &amp; 1.0 &amp; 2.0 &amp; 1.0 &amp; 3.0 &amp; 2.0 &amp; 1.0 &amp; 2.0\\1.0 &amp; 2.0 &amp; 1.0 &amp; 2.0 &amp; 2.0 &amp; 3.0 &amp; 2.0 &amp; 1.0\\1.0 &amp; 2.0 &amp; 3.0 &amp; 2.0 &amp; 2.0 &amp; 1.0 &amp; 2.0 &amp; 1.0\\2.0 &amp; 1.0 &amp; 2.0 &amp; 3.0 &amp; 1.0 &amp; 2.0 &amp; 1.0 &amp; 2.0\\3.0 &amp; 2.0 &amp; 1.0 &amp; 2.0 &amp; 2.0 &amp; 1.0 &amp; 2.0 &amp; 1.0\\2.0 &amp; 3.0 &amp; 2.0 &amp; 1.0 &amp; 1.0 &amp; 2.0 &amp; 1.0 &amp; 2.0\end{matrix}\right),K = \left(\begin{matrix}0.0 &amp; 10.0 &amp; 2.5 &amp; 10.0 &amp; 10.0 &amp; 2.5 &amp; 1.11111111111111 &amp; 2.5\\10.0 &amp; 0.0 &amp; 10.0 &amp; 2.5 &amp; 2.5 &amp; 10.0 &amp; 2.5 &amp; 1.11111111111111\\2.5 &amp; 10.0 &amp; 0.0 &amp; 10.0 &amp; 1.11111111111111 &amp; 2.5 &amp; 10.0 &amp; 2.5\\10.0 &amp; 2.5 &amp; 10.0 &amp; 0.0 &amp; 2.5 &amp; 1.11111111111111 &amp; 2.5 &amp; 10.0\\10.0 &amp; 2.5 &amp; 1.11111111111111 &amp; 2.5 &amp; 0.0 &amp; 10.0 &amp; 2.5 &amp; 10.0\\2.5 &amp; 10.0 &amp; 2.5 &amp; 1.11111111111111 &amp; 10.0 &amp; 0.0 &amp; 10.0 &amp; 2.5\\1.11111111111111 &amp; 2.5 &amp; 10.0 &amp; 2.5 &amp; 2.5 &amp; 10.0 &amp; 0.0 &amp; 10.0\\2.5 &amp; 1.11111111111111 &amp; 2.5 &amp; 10.0 &amp; 10.0 &amp; 2.5 &amp; 10.0 &amp; 0.0\end{matrix}\right),L = \left(\begin{matrix}0.0 &amp; 10.0 &amp; 20.0 &amp; 10.0 &amp; 10.0 &amp; 20.0 &amp; 30.0 &amp; 20.0\\10.0 &amp; 0.0 &amp; 10.0 &amp; 20.0 &amp; 20.0 &amp; 10.0 &amp; 20.0 &amp; 30.0\\20.0 &amp; 10.0 &amp; 0.0 &amp; 10.0 &amp; 30.0 &amp; 20.0 &amp; 10.0 &amp; 20.0\\10.0 &amp; 20.0 &amp; 10.0 &amp; 0.0 &amp; 20.0 &amp; 30.0 &amp; 20.0 &amp; 10.0\\10.0 &amp; 20.0 &amp; 30.0 &amp; 20.0 &amp; 0.0 &amp; 10.0 &amp; 20.0 &amp; 10.0\\20.0 &amp; 10.0 &amp; 20.0 &amp; 30.0 &amp; 10.0 &amp; 0.0 &amp; 10.0 &amp; 20.0\\30.0 &amp; 20.0 &amp; 10.0 &amp; 20.0 &amp; 20.0 &amp; 10.0 &amp; 0.0 &amp; 10.0\\20.0 &amp; 30.0 &amp; 20.0 &amp; 10.0 &amp; 10.0 &amp; 20.0 &amp; 10.0 &amp; 0.0\end{matrix}\right)\]</span> このとき、ランダム生成した座標からkamada-kawai法により頂点位置の最適化を行なうと、頂点座標は次のようになる。 <span class="math display">\[P = \left(\begin{matrix}8.72943602668481 &amp; 3.23905673749775\\15.5280870507712 &amp; -6.94650275884476\\4.714943362793 &amp; -6.16056225587634\\-1.28270289126781 &amp; 3.96868156153436\\16.9263133044473 &amp; 12.3416486584704\\22.9239485695035 &amp; 2.2123941380819\\12.9118135158373 &amp; 2.94207317764793\\6.11314925797029 &amp; 13.127590656225\end{matrix}\right)\]</span></p>
<p>プロットした画像は次のようになる。</p>
<div class="figure">
<img src="pics/cube.png" alt="img" />
<p class="caption">img</p>
</div>
</body>
</html>
